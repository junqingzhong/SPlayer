# SPlayer API Documentation

This document outlines the backend API endpoints used by SPlayer. The backend server is built with Fastify and provides access to the Netease Cloud Music API (via the `NeteaseCloudMusicApi` package) and a custom Unblock API.

## Main API Files

-   `electron/server/index.ts`: Main Fastify server setup and registration of API modules.
-   `electron/server/netease/index.ts`: Integration with the `NeteaseCloudMusicApi` Node.js package.
-   `electron/server/unblock/index.ts`: Custom API for attempting to unblock songs.
-   `src/api/`: Contains frontend (Vue.js) services that consume these backend APIs.

## Server Configuration

-   **Base URL**: The local server runs at `http://localhost:25884/api` by default. The port can be configured via the `VITE_SERVER_PORT` environment variable.

## Netease Cloud Music API

SPlayer uses the `NeteaseCloudMusicApi` Node.js package (version `^4.27.0` as per `package.json`) to interact with the Netease Cloud Music service.

-   **Official Documentation**: For a complete list of all available Netease API functions, their parameters, and response structures, please refer to the official documentation for the `NeteaseCloudMusicApi` package: [https://docs-neteasecloudmusicapi.vercel.app/](https://docs-neteasecloudmusicapi.vercel.app/)
-   **Route Generation**:
    -   The SPlayer backend dynamically creates routes for all functions available in the `NeteaseCloudMusicApi` library.
    -   The API path is generated by converting the `camelCase` or `PascalCase` function name from the library into `path-case`.
    -   For example, if the library has a function `searchSong`, SPlayer exposes it as `GET /api/netease/search-song` and `POST /api/netease/search-song`.
    -   Routes with underscores in their original names are also preserved (e.g., `some_route` becomes `/api/netease/some_route`).
-   **Metadata Endpoint**:
    -   `GET /api/netease`: Provides metadata about the version of the `NeteaseCloudMusicApi` wrapper being used by SPlayer.

**Example Common Endpoints (derived from library functions):**

-   `/api/netease/login-cellphone` (for phone login)
-   `/api/netease/user-playlist` (to get user playlists)
-   `/api/netease/song-url-v1` (to get song playback URLs)
-   `/api/netease/lyric` (to get song lyrics)
-   `/api/netease/search` (for general search)
-   `/api/netease/album` (to get album details)
-   `/api/netease/artist-detail` (to get artist details)
-   ... and many more, as listed in the official documentation.

## Unblock API

This API attempts to find alternative playback sources for songs.

-   **File**: `electron/server/unblock/index.ts`
-   **Base Path**: `/api/unblock`

**Endpoints:**

1.  **GET `/api/unblock`**
    *   **Description**: Provides metadata about the Unblock API service.
    *   **Response**: JSON object with service name, description, and author.

2.  **GET `/api/unblock/netease`**
    *   **Description**: Attempts to get a Netease song URL from an alternative source (GD音乐台).
    *   **Query Parameters**:
        *   `id` (required): The Netease song ID.
    *   **Response**: JSON object with `code` (e.g., 200 for success, 404 for not found) and `url` (the song URL if found).
    *   **Example**: `/api/unblock/netease?id=123456`

3.  **GET `/api/unblock/kuwo`**
    *   **Description**: Attempts to get a Kuwo song URL based on a keyword.
    *   **Query Parameters**:
        *   `keyword` (required): The search keyword (e.g., song title and artist).
    *   **Response**: JSON object, likely containing song URL and other metadata if found. (The exact structure depends on `getKuwoSongUrl` from `electron/server/unblock/kuwo.ts`).
    *   **Example**: `/api/unblock/kuwo?keyword=SongTitle%20ArtistName`
